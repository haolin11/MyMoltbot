# 2026-01-28 Session Notes

## CasePilot UI Refactor (continued)

Colin provided feedback on the collaboration flow for CasePilot.

### Key direction from Colin:
- The product is about **方案书 (proposal documents)**, not just chat + cards
- Main view should be **large document area** (proposal text), not cards/checklists dominating
- User should see generated draft proposal after stating requirements
- Document must be **directly editable** (contenteditable)
- Chat is for continuous collaboration/refinement, lives in side panel
- Still support metrics/evidence/boundaries as lightweight side cards

### Changes made:
1. Rewrote `P-SOLUTION_GENERATOR.html` with new layout:
   - Left 8 cols: **方案书（可编辑）** with sections: 概述, 系统架构, 验收指标与口径, 风险边界与护栏, 交付物清单
   - Right 4 cols: sticky side panel with tabs (对话/清单/证据) + metrics + boundaries cards
   - All document sections use `contenteditable="true"` with `data-doc="..."` attribute

2. Rewrote `assets/app.js` with document-first logic:
   - `generateDraftFromNeed(need)` creates structured proposal text
   - `renderDocument(state)` populates editable sections
   - Document edits auto-persist via `input` event listener
   - State key changed to `cp.collab.docfirst`

3. Tabs in side panel: 对话 | 清单 | 证据 (JS toggle logic inline in HTML)

### Commits:
- `a0c0e71` Shift UI to Notion-like collaboration flow
- `9143869` Make generator document-first with editable draft

### Dev server:
- Running on port 19001 (Python SimpleHTTPServer)
- URL pattern: `https://orange-parakeet-xvrgp5x5wr42975r-19001.app.github.dev/`

### Next steps (Colin to decide):
1. Smarter questioning in chat
2. Better editing (add/delete/drag for metrics/evidence)
3. Export/print as formal proposal document
