<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>历史方案 · CasePilot</title>

  <script src="assets/tailwind-config.js"></script>
  <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
  <link rel="stylesheet" href="assets/styles-v5.css" />
  <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
</head>
<body class="bg-bg-primary min-h-screen cp-grid-bg">
  <header class="sticky top-0 z-50 glass">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <!-- Logo区域 - 固定宽度 -->
      <a href="P-HOME.html" class="flex items-center gap-3" style="min-width: 220px;">
        <div class="w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden bg-white logo-icon">
          <img src="assets/logo.png" alt="CasePilot Logo" class="w-full h-full object-contain" />
        </div>
        <div class="leading-tight">
          <div class="text-xl font-bold gradient-text whitespace-nowrap logo-text-brand">CasePilot</div>
          <div class="text-sm text-text-secondary whitespace-nowrap logo-text-subtitle">历史方案</div>
        </div>
      </a>

      <!-- 导航菜单 - 固定宽度居中 -->
      <nav class="hidden md:flex items-center gap-1" style="min-width: 380px; justify-content: center;">
        <a class="nav-link px-4 py-2 text-base whitespace-nowrap" href="P-HOME.html">首页</a>
        <a class="nav-link px-4 py-2 text-base whitespace-nowrap" href="P-SOLUTION_GENERATOR.html">协作生成</a>
        <a class="nav-link px-4 py-2 text-base whitespace-nowrap" href="P-CASE_LIBRARY.html">案例库</a>
        <a class="nav-link-active px-4 py-2 text-base whitespace-nowrap" href="P-SOLUTION_HISTORY.html">历史方案</a>
      </nav>

      <!-- 右侧操作区 - 固定宽度右对齐 -->
      <div class="flex items-center gap-3 justify-end" style="min-width: 240px;">
        <a href="P-SOLUTION_GENERATOR.html" class="inline-flex items-center gap-2 cp-btn cp-btn-primary text-base px-4 py-2 whitespace-nowrap">
          <i class="fa-solid fa-plus"></i>
          新方案
        </a>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3">
      <div>
        <h1 class="text-3xl font-extrabold">历史方案</h1>
        <p class="mt-2 text-text-secondary">按完成度与可交付要素快速浏览。</p>
      </div>
      <div class="flex items-center gap-2">
        <input class="px-4 py-2 rounded-xl border border-border-light search-focus bg-white" placeholder="搜索标题（演示）" />
        <button class="px-4 py-2 rounded-xl border border-border-light bg-white hover:bg-bg-secondary">筛选</button>
      </div>
    </div>

    <div class="mt-6 grid lg:grid-cols-3 gap-4" id="cp-history"></div>
  </main>

  <footer class="border-t border-border glass">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 flex flex-col sm:flex-row gap-3 sm:items-center sm:justify-between">
      <div class="text-sm text-text-secondary">© CasePilot v5.0 · Engineering-grade AI Output</div>
      <div class="text-sm text-text-secondary flex items-center gap-4">
        <a class="hover:text-accent transition-colors" href="P-SOLUTION_GENERATOR.html">协作生成</a>
        <a class="hover:text-accent transition-colors" href="P-LOGIN_REGISTER.html">登录</a>
      </div>
    </div>
  </footer>

  <script>
    (function(){
      function esc(s){return String(s||'').replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');}
      let hist=[];
      try{ hist = JSON.parse(localStorage.getItem('cp.history')||'[]') || []; }catch{ hist=[]; }
      const el = document.getElementById('cp-history');
      if(!el) return;
      if(!hist.length){
        el.innerHTML = `<div class="cp-card p-6 text-text-secondary">暂无历史。<a class="text-primary" href="P-SOLUTION_GENERATOR.html">从协作生成开始</a></div>`;
        return;
      }
      el.innerHTML = hist.map(h=>{
        const score = h.score || '-';
        return `<a class="cp-card cp-card-hover p-5 block" href="P-SOLUTION_DETAIL.html#run=${encodeURIComponent(h.id)}">
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="font-extrabold">${esc(h.title)}</div>
              <div class="mt-1 text-xs text-text-secondary">更新：${esc(h.updatedAt)}</div>
            </div>
            <span class="text-xs cp-pill px-2 py-1 rounded-full">完成度 ${esc(score)}</span>
          </div>
          <div class="mt-4 grid grid-cols-3 gap-2 text-xs">
            <span class="cp-pill px-2 py-1 rounded-full">可追溯</span>
            <span class="cp-pill-warn px-2 py-1 rounded-full">可验收</span>
            <span class="cp-pill-primary px-2 py-1 rounded-full">边界</span>
          </div>
        </a>`;
      }).join('');
    })();
  </script>
</body>
</html>
